<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width" name="viewport" />
<meta content="yes" name="apple-mobile-web-app-capable" />
<meta content="black" name="apple-mobile-web-app-status-bar-style" /> 
<meta content="telephone=no" name="format-detection" />
<title>打印报告-</title>
<style type="text/css">
/* 初始化开始*/
html {-webkit-text-size-adjust: 100%;-ms-text-size-adjust: 100%; font-size: 100px;}
*{margin:0; padding:0;/* border:none;*/box-sizing:border-box;}
html,body{height: 100%;margin:0;padding:0;}
body{background-color:#fff;color:#333333;font:.12rem/.24rem "Microsoft YaHei"; max-width: 600px; margin: 0 auto;}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,textarea,p,blockquote,th,td,hr,button,article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section {
margin:0;
padding:0;
}
ol,ul,li{ list-style: none;}
img {max-width: 100%;height: auto;width:auto\9; /* ie8 */border: none;}
em,i,b{font-weight: normal;font-style: normal;}
a{text-decoration:none; color: #333333;}
li{list-style:none;}
h1, h2, h3, h4, h5, h6{ font-size:100%;font-weight: normal;}
.clearfix{zoom:1;}
.fl{float:left;}
.fr{float:right;}
.clearfix:after{content:""; display:block; visibility:hidden; height:0; clear:both;}
.img_b{ display: block; width: 100%;}
input,textarea{ background: none; outline: none; font-family: "微软雅黑";}
input[type="submit"],
input[type="reset"],
input[type="button"],
input{-webkit-appearance:none; resize: none;}
/* 初始化结束 */
.k1{ height: .14rem;}
.top_cn .btt{ line-height: .55rem; text-align: center; color: #21a197; font-size: .24rem; font-family:'宋体'; font-weight: bold; position: relative;}
.top_cn .btt .bm{ position: absolute; left: 4.5rem; top:.05rem; font-size: .13rem; color: #333333;}
.top_cn .info{ line-height: .55rem; font-weight: bold; color: #000;}
.tit-b{ margin: .12rem 0; height: .26rem; line-height: .26rem; font-weight: bold;}
.state-c{ height: .8rem;}
.state-c span{ width: .7rem; display: inline-block; vertical-align: top; line-height: .8rem; color: #02cab4;}
.state-c font{ width:.65rem; display: inline-block; vertical-align: top; line-height: .8rem; color: #02cab4; font-size: .38rem;}
.state-c em{display: inline-block; vertical-align: top; line-height: .8rem;}
.state-c em i{ color: #ed2222;}
.tet-c{margin: .05rem 0; height: .14rem; line-height: .13rem; color: #ed2222;}
.tet-c i{ width: .06rem; height: .13rem; display: inline-block; background: #02cab4;}
.tet-c span{ display: inline-block; vertical-align: top; margin: 0 .4rem 0 .1rem; line-height: .13rem; }
.tet-t{ color: #d30000;}
.sta_1{ border: #333 solid 2px; border-bottom: 1px solid #333; font-size: 0;}
.sta_1 .plin{ display: inline-block; width: 50%; vertical-align: top; height: .25rem; line-height: .24rem; border-bottom: #333 1px solid; border-right: #333 1px solid;}
.sta_1 .plin:nth-child(even){border-right:none;}
.sta_1 .plin label{ display: inline-block; vertical-align: top; width:24%; height: .25rem; padding-left:.1rem; font-size: .12rem; border-right: #333 1px solid;}
.sta_1 .plin .sst{ display: inline-block; vertical-align: top; width: 76%; height: .25rem; padding-left:.1rem;}
.sta_1 .plin .sst2{ display:none; vertical-align: top; width: 88%; padding-left: .1rem; font-size: .12rem;}
.sta_1 .plin .sst img{ display: none; width: .15rem; height: .15rem; vertical-align: middle;}
.sta_1 .plin .sst img.show{ display: inline-block;}
.sta_1 .plin .ssy{ display: inline-block; vertical-align: top; width: 88%; padding-left: .1rem; font-size: .12rem;}
.sta_2{ border: #333 solid 1px;}
.sta_2 .btt{ line-height: .24rem; border-bottom: #333 solid 1px; font-size: .13rem;}
.sta_2 .btt span{ display: inline-block; padding: 0 .2rem; margin-right: .1rem;}
.sta_2 .xtt{ font-size: 0; line-height: .3rem;}
.sta_2 .xtt p.tte{ font-size: .12rem; padding-left: .12rem;}
.sta_2 .xtt p.tte em{ display: inline-block;padding: 0 .2rem; margin-right: .1rem; font-weight: bold;}
.sta_2 .xtt p.tte em:first-of-type{ width: 120px;}
.sta_2 .xtt span{ display: inline-block;width: 50%; padding: 0 .2rem 0 .3rem; font-size: .12rem;}
.sta_2 .xtt span em{ display: inline-block; vertical-align: top;}
.sta_2 .xtt span em:nth-of-type(1){ width: 55%;}
.sta_2 .xtt span em:nth-of-type(2){ width: 22%;}
.sta_2 .xtt span em:nth-of-type(3){ width: 22%;}
.sta_2 .cy{color: #ffcb00;}
.sta_2 .co{ color: #ed2222;}
.wxtip{ border: #333 solid 1px; padding: .1rem;}
.bgtip{ padding: 0 .12rem; font-size: .13rem; line-height: .32rem;}
.jk_sug{ border: #333 solid 1px; margin-bottom: 25px;}
.jk_sug .btit{ padding: 0 0 0 20px; border-bottom: #333 solid 1px; line-height: 30px; font-size: 15px;}
.jk_sug .ztit{ padding: 0 10px 0 20px; border-bottom: #333 solid 1px; line-height: 26px;}
.jk_sug .box_c{ display: -webkit-box; border-bottom: #333 solid 1px;}
.jk_sug .box_c:last-of-type{ border-bottom: none;}
.jk_sug .box_c .lab{ display: block; padding: 10px; width:120px; line-height: 26px; border-right: #333 solid 1px;}
.jk_sug .box_c .con{-webkit-box-flex: 1; padding: 10px;}
.xxzb_c{ margin-bottom: 25px; border: #333 solid 1px;}
.xxzb_c .cy{color: #ffcb00;}
.xxzb_c .co{ color: #ed2222;}
.xxzb_c .c_tit{ line-height: 30px; border-bottom: #333 solid 1px; padding:0 20px;}
.xxzb_c .c_tit span{display: inline-block; width: 100px; font-size: 15px;}
.xxzb_c .c_con{ display: -webkit-box; border-bottom: #333 solid 1px; min-height: 29px;}
.xxzb_c .c_con:last-of-type{ border-bottom: none;}
.xxzb_c .c_con .second{ display:block; width: 24%; border-right: #333 solid 1px; position: relative;}
.xxzb_c .c_con .second span{ position: absolute; top: 50%; transform: translateY(-50%); line-height: 20px;}
.xxzb_c .c_con .second em{ display:inline-block; padding: 0 5px; text-align: center; font-weight: bold;}
.xxzb_c .c_con .third{ -webkit-box-flex: 1; font-size: 0;}
.xxzb_c .c_con .third span.ite{ display: inline-block; width: 49.9%; line-height: 32px;}
.xxzb_c .c_con .third span:nth-child(odd){ border-right: #333 solid 1px;}
.xxzb_c .c_con .third span:nth-last-of-type(2) em{ border-bottom: none;}
.xxzb_c .c_con .third span:last-of-type em{ border-bottom: none;}
.xxzb_c .c_con .third span em{ display: inline-block; font-size: .12rem; border-bottom: #333 solid 1px;}
.xxzb_c .c_con .third span em:first-of-type{ width: 50%; padding-left: 10px;}
.xxzb_c .c_con .third span em:nth-of-type(2){ width: 25%;}
.xxzb_c .c_con .third span em:nth-of-type(3){ width: 25%; text-align: center;}
.sstxt i{color: #ed2222;}
</style>
</head>
<body>
<div id="app">
<!--<div style="padding:.2rem 0 0; position: relative;">
	<img class="img_b" src="img/top.jpg"/>
	<p style="position: absolute; right: .1rem; top: .3rem; font-size: .14rem;">为您的健康加分</p>
</div>-->
<div class="top_cn">
	<p class="btt">{{language.la_reportTit}}<span class="bm">{{language.la_num}}：</span></p>
	<div class="info">{{language.la_cell}}：{{mobile.slice(0,11)}} 　　　　{{language.la_sex}}：{{sex==1?language.la_male:'女'}} 　　　　<span v-if="realAge" class="realAge">{{language.la_age}}：<em>{{realAge}}</em></span>　　　　　{{language.la_testday}}：{{inspectDateStr}} </div>
</div>
<div class="">
	{{language.la_dear}}{{userName }} {{language.la_hello}}！<br/>
	{{language.la_thanksForUse}}
</div>
<div class="tit-b">{{language.la_ztit}}</div>
<div class="state-c">
	<span>{{language.la_zongfen}}:</span><font>{{totalScore}}</font><em v-if="ranking">{{language.la_hzContent_3}}<i>{{ranking}}%</i> {{language.la_hzContent_4}}</em>
</div>
<div class="tit-b">{{language.la_pinggu}}</div>

<div class="txt-c">
	<div class="sstxt">
		1、{{language.la_benci}}
		<em class="sta" v-if="language == zh">{{ps}}.</em>
		<em class="sta" v-else>{{ps_en}}.</em>
		<span v-if="age">{{language.la_hzContent_1}}<em class="sta">{{age}}</em>{{language.la_hzContent_2}}</span>
		<span v-if="ranking">{{language.la_hzContent_3}}<em class="sta">{{ranking}}</em>{{language.la_hzContent_4}}</span>；
		<p>
			2、{{language.la_huizong1}}
			<span v-if="list4.length"><template v-for="bid in list4"><i> {{bid}}</i></template>{{language.la_huizong2}}</span>
			<span v-if="list3.length"><template v-for="bid in list3"><i> {{bid}}</i></template>{{language.la_huizong3}}</span>
			<span v-if="litmsklength">{{language.la_huizong4}}<font>{{litmsklength}}</font>{{language.la_huizong5}}</span>
			{{language.la_huizong6}}
		</p>
		<p v-if="abnormalName">3、{{language.la_huizong7}}
			<template v-for="(bid,index) in abnormalName">
				<i v-if="index == (abnormalName.lenght-1)">{{bid}}</i>
				<i v-else>{{bid}}、</i>
			</template>
		{{language.la_huizong8}}</p>
		<p v-else>3、{{language.la_huizong9}}</p>
		
	</div>
</div>

<div class="tit-b">{{language.la_detail}}</div>
<div class="xxzb_c" v-for="state in firsts" v-if="state.targetId != 1001">
	<p class="c_tit"><span>{{state.targetName}}</span><span class="iscore">{{state.score}}</span>
		<span v-if="state.score >= 90">{{language.la_normal}}</span>
		<span class="cy" v-if="state.score >= 80 && state.score < 90">{{language.la_MildSisk}}</span>
		<span class="co" v-if="state.score < 80">{{language.la_ModerateSisk}}</span>
	</p>
	<div class="c_con" v-for="second in state.seconds">
		<div class="second">
			<span class=""><em>{{second.targetName}}</em><em class="iscore">{{second.score}}</em>
				<em v-if="state.score >= 90">{{language.la_normal}}</em>
				<em class="cy" v-if="state.score >= 80 && state.score < 90">{{language.la_MildSisk}}</em>
				<em class="co" v-if="state.score < 80">{{language.la_ModerateSisk}}</em>
			</span>
		</div>
		<p class="third">
			<span class="ite" v-for="third in second.thirds" v-if="third.targetId != 3089 && third.targetId != 3207 && third.targetId != 3097 && third.targetId != 3110 && third.targetId != 3211 && third.targetId != 3219 && third.targetId != 3139">
			<template>
				<em>{{third.targetName}}</em><em class="iscore">{{third.score}}</em>
				<em v-if="third.inspectStandard==1">{{language.la_normal}}</em>
				<em v-else-if="third.inspectStandard==2" class="co">{{language.la_piangao}}</em>
				<em v-else class="co">{{language.la_piandi}}</em>
			</template>
			</span>
		</p>
	</div>
</div>

<div class="tit-b">{{language.la_zhuangtai}}</div>
<div class="sta_1">
	<p class="plin" v-for=" state in conditions" v-if="state.targetId != 3232">
		<label>{{state.targetName}}</label>
		<span class="sst">
			<img v-for="index of (5-state.abnormalLevel)" src="img/star.png" class="show">
			<!-- <img src="img/star.png"> -->
		</span>
		<i>{{6-state.abnormalLevel}}</i>
		<span class="sst2">{{state.analysisResults}}</span>
	</p>
</div>
	
<div class="tit-b">{{language.la_jkAdvice}}</div>
<div class="jk_sug">
	<p class="btit">{{language.la_sug_diet}}</p>
	<!--<p class="ztit">
		膳食、营养专家 肖荣教授领衔的专家团队为您提供。<br>
		肖 荣　博士/教授，博士生导师、中国营养学会常务理事 、中国优生科学协会常务理事、中国营养学会学术交流工作委员会委员、北京营养师协会副理事长、首都医科大学公共卫生学院营养与食品卫生学系主任<br/>
	</p>-->
	<div class="box_c" v-for="(site,index) in sites">
		<span class="lab">{{index+1}}、{{site.indexName}}</span>
		<div class="con">
			<p class="txt1">{{site.personality}}</p>
			<p class="txt2" v-html="site.proposal"></p>
		</div>
	</div>
</div>
<div class="jk_sug">
	<p class="btit">{{language.la_sug_nut}}</p>
	<!--<p class="ztit">
		膳食、营养专家 肖荣教授领衔的专家团队为您提供。<br>
		肖 荣　博士/教授，博士生导师、中国营养学会常务理事 、中国优生科学协会常务理事、中国营养学会学术交流工作委员会委员、北京营养师协会副理事长、首都医科大学公共卫生学院营养与食品卫生学系主任<br/>
	</p>-->
	<div class="box_c" v-for="(oli,index) in oul">
		<span class="lab">{{index+1}}、{{oli.indexName}}</span>
		<div class="con">
			<p class="txt1">{{oli.personality}}</p>
			<p class="txt2" v-html="oli.proposal"></p>
		</div>
	</div>
</div>
<div class="jk_sug">
	<p class="btit">{{language.la_sug_sport}}</p>
	<!--<p class="ztit">
		运动学专家 高岭娣教授、生活方式专家 潘晓明博士领衔的专家团队为您提供。<br>
		高岭娣　首都医科大学卫生与教育管理学院体育学系主任/副教授<br/>
		潘晓明　中医博士、北京大学医学部研究中心学术部副主任、深圳市中医药健康服务协会副会长；<br/>
	</p>-->
	<div class="box_c" v-for="(sport,index) in sports">
		<div class="con">
			<p class="txt1">{{index+1}}.{{sport.personality}}</p>
		</div>
	</div>
</div>

<p class="bgtip">{{language.la_again_befor}}<span>{{inspectDay}}</span>{{language.la_again_after}}</p>

<p style="height: 1rem;"></p>
<div class="wxtip">
	{{language.la_tips}}
</div>
<p class="k1"></p>
</div>
<script src="js/jquery.js"></script>
<script>document.write('<script src="../js/base.js?t=' + new Date().getTime() + '"><\/script>')</script>
<script src="js/language.js"></script>
<script src="js/vue.min.js"></script>
<script>
var JsSrc =(navigator.language || navigator.browserLanguage).toLowerCase();  //获取系统语言
if(JsSrc.indexOf('zh')>=0){
	var language = zh;
	var languageStr = 'zh';
}else if(JsSrc.indexOf('en')>=0){
    var language = en;
    var languageStr = 'en';
    document.title = 'Health report'
}else{
	var language = en;
    var languageStr = 'en';
    document.title = 'Health report'
}
console.log(languageStr)
var reportId = getQueryString('reportId');
var viewType = getQueryString("viewType");
var go = 0;
if(viewType == 2){
	go = 10 //随便给个数 不让调用打印
}
var myapp = new Vue({
	el:'#app',
	data: function () {
		return {
			userName:'', //用户名
			sexStr:'', //性别称呼
			ps :'', // 状态
			inspectDay:'', // 提醒天数
			totalScore:'',
			age:'',
			realAge:'',
			inspectDateStr:'',
			ranking:'',
			improves: '',  //旧版
			firsts: '',  //各个系统指标
			conditions: '',  //各个状态
			sex: '',
			titleSex:'',
			nickName: '',
			mobile: '',	
			sites: [], //膳食建议
			oul: [], // 营养建议
			sports: [], //运动建议
			options:['一','二','三','四','五','六','七','八','九','十','十一','十二','十三','十四','十五','十五','十六'],
			litmsklength:0,
			list2:[], //轻度
			list3:[],  //中度
			list4:[],  //重度
			abnormalName:[],
			language:language,
			ps_en:''
		}
	},
	methods: {
		getReportPrint: function(){
			var vm = this
			$.ajax({
				url : dataUrl+"/api/v1/printReport/getReportPrint",
				type : "POST",
				dataType : 'json',
				data : {
					reportId: reportId
				},
				success : function(allData) {
					if(allData.code == 200){
						vm.totalScore = allData.data.reportView.totalScore
						vm.ps_en = vm.fenshu(vm.totalScore);
						vm.age = allData.data.reportView.age
						vm.realAge = allData.data.infoView.age
						vm.inspectDateStr = allData.data.reportView.inspectDateStr.substring(0,10)
						vm.ranking = allData.data.reportView.ranking
						vm.improves = allData.data.reportView.improves  //旧版
						vm.firsts = allData.data.reportView.firsts  //各个系统指标
						vm.conditions = allData.data.reportView.conditions  //各个状态
						vm.sex = allData.data.reportView.sex
						vm.titleSex = allData.data.reportView.titleSex
						vm.nickName = allData.data.infoView.nickName
						vm.mobile = allData.data.infoView.mobile
						if(allData.data.infoView != null){
							var nickName = allData.data.infoView.nickName ,mobile = allData.data.infoView.mobile;
							document.title = nickName + mobile;
							if(nickName == null){document.title = mobile}
							if(nickName == null && mobile == null){document.title = '打印报告'}
						}
						go++;
						goPrint(go);
					}
				},
				error : function(obj,msg){alert(obj  + msg);}
			});
		},
		getSuggest: function(){
			var vm = this
			$.ajax({
				url : dataUrl+"/api/v1/reportIndex/getSuggest",
				type : "POST",
				dataType : 'json',
				data : {
					reportId: reportId
				},
				success : function(improvesData) {
					if(improvesData.code == 200){
						vm.userName = improvesData.data.userName; //用户名
						vm.sexStr = improvesData.data.sexStr; //性别称呼
						vm.ps = improvesData.data.ps; // 状态
						vm.inspectDay = improvesData.data.inspectDay; // 提醒天数
						vm.litmsklength = improvesData.data.abnormal.list2.length
						if(improvesData.data){
							vm.list2 = improvesData.data.abnormal.list2
							vm.list3 = improvesData.data.abnormal.list3
							vm.list4 = improvesData.data.abnormal.list4
							vm.abnormalName = improvesData.data.abnormalName
						}
						if(improvesData.data.healthAdviceVo.dietList!=null){
							for(var i=0;i<improvesData.data.healthAdviceVo.dietList.length;i++){
							var newprop = improvesData.data.healthAdviceVo.dietList[i].proposal.replace(/\n/g, "<br/>");
							improvesData.data.healthAdviceVo.dietList[i].proposal = newprop;
							}
						};
						vm.sites = improvesData.data.healthAdviceVo.dietList, //膳食建议
						vm.oul = improvesData.data.healthAdviceVo.nutritionList, // 营养建议
						vm.sports = improvesData.data.healthAdviceVo.motionList, //运动建议
						go++;
						goPrint(go);
					}
				
				},
				error : function(obj,msg){alert(obj  + msg);}
			});
		},
		fenshu: function(totalScore){
			if (totalScore >= 95) {
				return "Very good";
			} else if (totalScore >= 90 && totalScore <= 94) {
				return "Good";
			} else if (totalScore >= 85 && totalScore <= 89) {
				return "Mild sub-health";
			} else if (totalScore < 85) {
				return "Obvious sub-health";
			}
		}
	},
	mounted: function (){
		this.getReportPrint()
		this.getSuggest()
	}
})

// 获取url参数方法
function getQueryString(name) {
    var result = window.location.search.match(new RegExp("[\?\&]" + name + "=([^\&]+)", "i"));
    if (result == null || result.length < 1) {
        return "";
    }
    return result[1];
};
function goPrint(n){
	if(n == 2){
		setTimeout(function(){
			window.print();
		},800)
		
	}
};	
</script>
</body>
</html>
